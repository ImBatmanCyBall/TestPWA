!function(o,t,n){"use strict";var i,e,s,a,r=!1,l={isCompatible:!1},d={},u={appID:"com.love2dev.addtohome",appName:"Progressive Web App",debug:!1,logging:!1,modal:!1,mandatory:!1,autostart:!0,skipFirstVisit:!1,minSessions:0,startDelay:1,lifespan:15,displayPace:1440,mustShowCustomPrompt:!1,maxDisplayCount:0,validLocation:[],onInit:null,onShow:null,onAdd:null,onInstall:null,onCancel:null,customCriteria:null,manualPrompt:null},p={lastDisplayTime:0,returningVisitor:!1,displayCount:0,optedout:!1,added:!1,sessions:0,nextSession:0};function c(e){return i||(i={trigger:v,updateSession:I,clearSession:A,removeSession:f,optOut:P,optIn:x,clearDisplayCount:D,triggerNativePrompt:g},"serviceWorker"in navigator?t.querySelector("[rel='manifest']")?(d=Object.assign({},u,e),navigator.serviceWorker.getRegistration().then(y)):console.log("no manifest file"):(m("service worker not supported"),m("Add to homescreen: not displaying callout because service workers are not supported"))),i}function m(e){d.logging&&(d.logger||console).log(e)}function g(){return l.beforeInstallPrompt?l.beforeInstallPrompt.prompt().then(function(e){return l.beforeInstallPrompt.userChoice}).then(function(e){a.added="accepted"===e.outcome,a.added?(m("User accepted the A2HS prompt"),d.onAdd&&d.onAdd(e)):(d.onCancel&&d.onCancel(e),a.optedout=!0,m("User dismissed the A2HS prompt")),I(),l.beforeInstallPrompt=null}).catch(function(e){if(m(e.message),-1<e.message.indexOf("user gesture"))d.mustShowCustomPrompt=!0,S();else{if(!(-1<e.message.indexOf("The app is already installed")))return console.log(e),e;console.log(e.message),a.added=!0,I()}}):Promise.resolve()}function f(e){localStorage.removeItem(e||c.defaults.appID)}function y(e){i.sw=e,i.sw?((a="string"==typeof(a=(a=JSON.parse(localStorage.getItem(d.appID)))||p)?JSON.parse(a):a).sessions+=1,I(),e=o.navigator.userAgent,l.isIDevice=/iphone|ipod|ipad/i.test(e),l.isSamsung=/Samsung/i.test(e),l.isFireFox=/Firefox/i.test(e),l.isOpera=/opr/i.test(e),l.isEdge=/edg/i.test(e),l.isFireFox&&(l.isFireFox=/android/i.test(e)),l.isOpera&&(l.isOpera=/android/i.test(e)),l.isChromium="onbeforeinstallprompt"in o,l.isInWebAppiOS=!0===o.navigator.standalone,l.isInWebAppChrome=o.matchMedia("(display-mode: standalone)").matches,l.isMobileSafari=l.isIDevice&&-1<e.indexOf("Safari")&&e.indexOf("CriOS")<0,l.isStandalone=l.isInWebAppiOS||l.isInWebAppChrome,l.isiPad=l.isMobileSafari&&-1<e.indexOf("iPad"),l.isiPhone=l.isMobileSafari&&-1===e.indexOf("iPad"),l.isCompatible=l.isChromium||l.isMobileSafari||l.isSamsung||l.isFireFox||l.isOpera||l.isIDevice,d&&d.debug&&void 0===d.logging&&(d.logging=!0),d.mandatory=d.mandatory&&("standalone"in o.navigator||d.debug),d.modal=d.modal||d.mandatory,d.mandatory&&(d.startDelay=-.5),d.debug&&(l.isCompatible=!0),d.onInit&&d.onInit(i),(d.autostart?(m("Add to homescreen: autostart displaying callout"),b):r?C:b)()):(console.log("no service worker"),l.isCompatible=!1)}function h(){var e;return null!==d.customCriteria||d.customCriteria!==n?(e=!1,e="function"==typeof d.customCriteria?d.customCriteria():!!d.customCriteria,(d.customCriteria=e)||m("Add to homescreen: not displaying callout because a custom criteria was not met."),e):d.customCriteria}function b(e){a.shown&&!e?m("Add to homescreen: not displaying callout because already shown on screen"):(a.shown=!0,"interactive"===t.readyState||"complete"===t.readyState?S():t.onreadystatechange=function(){"complete"===t.readyState&&S()})}function S(){setTimeout(C(),1e3*d.startDelay+500)}function C(){!function(){if(e!==n)return e;if(e=!1,h())if(l.isCompatible)if(Date.now()-a.lastDisplayTime<6e4*d.displayPace)m("Add to homescreen: not displaying callout because displayed recently");else if(d.maxDisplayCount&&a.displayCount>=d.maxDisplayCount)m("Add to homescreen: not displaying callout because displayed too many times already");else if(a.sessions<d.minSessions)m("Add to homescreen: not displaying callout because not enough visits");else if(d.nextSession&&0<d.nextSession&&a.sessions>=d.nextSession)m("Add to homescreen: not displaying callout because waiting on session "+d.nextSession);else if(a.optedout)m("Add to homescreen: not displaying callout because user opted out");else if(a.added)m("Add to homescreen: not displaying callout because already added to the homescreen");else if(l.isStandalone)a.added||(a.added=!0,I(),d.onAdd&&d.onAdd(i,a)),m("Add to homescreen: not displaying callout because in standalone mode");else{if(a.returningVisitor||(a.returningVisitor=!0,I(),!d.skipFirstVisit))return e=!0,console.log("end canPrompt"),1;m("Add to homescreen: not displaying callout because skipping first visit")}else m("Add to homescreen: not displaying callout because device not supported");else s=!1}()?(s!==n?s:(s=!1,i.beforeInstallPrompt="onbeforeinstallprompt"in o,h()?a.optedout||a.added||l.isStandalone||!l.isCompatible?s:s=!0:void(s=!1)))&&d.onCanInstall&&d.onCanInstall(l,a,i):(i.beforeInstallPrompt="onbeforeinstallprompt"in o,d.onShow&&d.onShow(l,a,i),a.lastDisplayTime=Date.now(),a.displayCount++,I())}function v(){C()}function I(){localStorage.setItem(d.appID,JSON.stringify(a))}function A(){a=p,I()}function P(){a.optedout=!0,I()}function x(){a.optedout=!1,I()}function D(){a.displayCount=0,I()}"onbeforeinstallprompt"in o&&(o.addEventListener("beforeinstallprompt",function(e){e.preventDefault(),console.log("capturing the native A2HS prompt"),l.beforeInstallPrompt=e}),r=!0),"onappinstalled"in o&&o.addEventListener("appinstalled",function(e){m("a2hs"),a.added=!0,I(),d.onInstall&&d.onInstall(e)}),l.cancelPrompt=function(e){return e.preventDefault(),d.onCancel&&d.onCancel(),!1},l.handleInstall=function(e){var o;return d.onInstall&&d.onInstall(e),!l.beforeInstallPrompt||d.debug&&"native"!==(d.debug&&"string"==typeof d.debug?d.debug:l.isChromium&&o===n&&!o?"native":l.isFireFox?"firefox":l.isiPad?"ipad":l.isiPhone?"iphone":l.isOpera?"opera":l.isSamsung?"samsung":l.isEdge?"edge":l.isChromium?"chromium":"")||g(),!1},o.addToHomescreen=c}(window,document);